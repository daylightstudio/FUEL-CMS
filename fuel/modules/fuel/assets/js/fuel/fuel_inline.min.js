(function($){$.fn.ajaxSubmit=function(options){if(!this.length){log("ajaxSubmit: skipping submit process - no element selected");return this}var method,action,url,$form=this;if(typeof options=="function")options={success:options};method=this.attr("method");action=this.attr("action");url=typeof action==="string"?$.trim(action):"";url=url||window.location.href||"";if(url)url=(url.match(/^([^#]+)/)||[])[1];options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||"GET",iframeSrc:/^https/i.test(window.location.href||
"")?"javascript:false":"about:blank"},options);var veto={};this.trigger("form-pre-serialize",[this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var traditional=options.traditional;if(traditional===undefined)traditional=$.ajaxSettings.traditional;var qx,n,v,a=this.formToArray(options.semantic);
if(options.data){options.extraData=options.data;qx=$.param(options.data,traditional)}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var q=$.param(a,traditional);if(qx)q=q?q+"&"+qx:qx;if(options.type.toUpperCase()=="GET"){options.url+=(options.url.indexOf("?")>=
0?"&":"?")+q;options.data=null}else options.data=q;var callbacks=[];if(options.resetForm)callbacks.push(function(){$form.resetForm()});if(options.clearForm)callbacks.push(function(){$form.clearForm(options.includeHidden)});if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else if(options.success)callbacks.push(options.success);options.success=
function(data,status,xhr){var context=options.context||options;for(var i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])};var fileInputs=$("input:file:enabled[value]",this);var hasFileInputs=fileInputs.length>0;var mp="multipart/form-data";var multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp;var fileAPI=!!(hasFileInputs&&fileInputs.get(0).files&&window.FormData);log("fileAPI :"+fileAPI);var shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;
if(options.iframe!==false&&(options.iframe||shouldUseFrame))if(options.closeKeepAlive)$.get(options.closeKeepAlive,function(){fileUploadIframe(a)});else fileUploadIframe(a);else if((hasFileInputs||multipart)&&fileAPI){options.progress=options.progress||$.noop;fileUploadXhr(a)}else $.ajax(options);this.trigger("form-submit-notify",[this,options]);return this;function fileUploadXhr(a){var formdata=new FormData;for(var i=0;i<a.length;i++){if(a[i].type=="file")continue;formdata.append(a[i].name,a[i].value)}$form.find("input:file:enabled").each(function(){var name=
$(this).attr("name"),files=this.files;if(name)for(var i=0;i<files.length;i++)formdata.append(name,files[i])});options.data=null;var _beforeSend=options.beforeSend;options.beforeSend=function(xhr,options){options.data=formdata;if(xhr.upload)xhr.upload.onprogress=function(event){options.progress(event.position,event.total)};if(_beforeSend)_beforeSend.call(options,xhr,options)};$.ajax(options)}function fileUploadIframe(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var useProp=
!!$.fn.prop;if(a)if(useProp)for(i=0;i<a.length;i++){el=$(form[a[i].name]);el.prop("disabled",false)}else for(i=0;i<a.length;i++){el=$(form[a[i].name]);el.removeAttr("disabled")}if($(":input[name=submit],:input[id=submit]",form).length){alert('Error: Form elements must not have name or id of "submit".');return}s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id="jqFormIO"+(new Date).getTime();if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr("name");if(n==null)$io.attr("name",id);
else id=n}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:"absolute",top:"-1000px",left:"-1000px"})}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=status==="timeout"?"timeout":"aborted";log("aborting upload... "+e);this.aborted=1;$io.attr("src",s.iframeSrc);xhr.error=e;s.error&&s.error.call(s.context,xhr,
e,status);g&&$.event.trigger("ajaxError",[xhr,s,e]);s.complete&&s.complete.call(s.context,xhr,e)}};g=s.global;if(g&&!$.active++)$.event.trigger("ajaxStart");if(g)$.event.trigger("ajaxSend",[xhr,s]);if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global)$.active--;return}if(xhr.aborted)return;sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+".x"]=form.clk_x;s.extraData[n+".y"]=form.clk_y}}}var CLIENT_TIMEOUT_ABORT=
1;var SERVER_ABORT=2;function getDoc(frame){var doc=frame.contentWindow?frame.contentWindow.document:frame.contentDocument?frame.contentDocument:frame.document;return doc}var csrf_token=$("meta[name=csrf-token]").attr("content");var csrf_param=$("meta[name=csrf-param]").attr("content");if(csrf_param&&csrf_token){s.extraData=s.extraData||{};s.extraData[csrf_param]=csrf_token}function doSubmit(){var t=$form.attr("target"),a=$form.attr("action");form.setAttribute("target",id);if(!method)form.setAttribute("method",
"POST");if(a!=s.url)form.setAttribute("action",s.url);if(!s.skipEncodingOverride&&(!method||/post/i.test(method)))$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});if(s.timeout)timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT)},s.timeout);function checkState(){try{var state=getDoc(io).readyState;log("state = "+state);if(state.toLowerCase()=="uninitialized")setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")");cb(SERVER_ABORT);
timeoutHandle&&clearTimeout(timeoutHandle);timeoutHandle=undefined}}var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)extraInputs.push($('<input type="hidden" name="'+n+'">').attr("value",s.extraData[n]).appendTo(form)[0]);if(!s.iframeTarget){$io.appendTo("body");io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,false)}setTimeout(checkState,15);form.submit()}finally{form.setAttribute("action",a);if(t)form.setAttribute("target",t);else $form.removeAttr("target");
$(extraInputs).remove()}}if(s.forceSync)doSubmit();else setTimeout(doSubmit,10);var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed)return;try{doc=getDoc(io)}catch(ex){log("cannot access response document: ",ex);e=SERVER_ABORT}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort("timeout");return}else if(e==SERVER_ABORT&&xhr){xhr.abort("server abort");return}if(!doc||doc.location.href==s.iframeSrc)if(!timedOut)return;io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",
cb,false);var status="success",errMsg;try{if(timedOut)throw"timeout";var isXml=s.dataType=="xml"||doc.XMLDocument||$.isXMLDoc(doc);log("isXml="+isXml);if(!isXml&&window.opera&&(doc.body==null||doc.body.innerHTML==""))if(--domCheckCount){log("requeing onLoad callback, DOM not available");setTimeout(cb,250);return}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml)s.dataType="xml";xhr.getResponseHeader=
function(header){var headers={"content-type":s.dataType};return headers[header]};if(docRoot){xhr.status=Number(docRoot.getAttribute("status"))||xhr.status;xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText}var dt=(s.dataType||"").toLowerCase();var scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute("status"))||xhr.status;xhr.statusText=ta.getAttribute("statusText")||xhr.statusText}else if(scr){var pre=
doc.getElementsByTagName("pre")[0];var b=doc.getElementsByTagName("body")[0];if(pre)xhr.responseText=pre.textContent?pre.textContent:pre.innerText;else if(b)xhr.responseText=b.textContent?b.textContent:b.innerText}}else if(dt=="xml"&&!xhr.responseXML&&xhr.responseText!=null)xhr.responseXML=toXml(xhr.responseText);try{data=httpData(xhr,dt,s)}catch(e$0){status="parsererror";xhr.error=errMsg=e$0||status}}catch(e$1){log("error caught: ",e$1);status="error";xhr.error=errMsg=e$1||status}if(xhr.aborted){log("upload aborted");
status=null}if(xhr.status)status=xhr.status>=200&&xhr.status<300||xhr.status===304?"success":"error";if(status==="success"){s.success&&s.success.call(s.context,data,"success",xhr);g&&$.event.trigger("ajaxSuccess",[xhr,s])}else if(status){if(errMsg==undefined)errMsg=xhr.statusText;s.error&&s.error.call(s.context,xhr,status,errMsg);g&&$.event.trigger("ajaxError",[xhr,s,errMsg])}g&&$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active)$.event.trigger("ajaxStop");s.complete&&s.complete.call(s.context,
xhr,status);callbackProcessed=true;if(s.timeout)clearTimeout(timeoutHandle);setTimeout(function(){if(!s.iframeTarget)$io.remove();xhr.responseXML=null},100)}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s)}else doc=(new DOMParser).parseFromString(s,"text/xml");return doc&&doc.documentElement&&doc.documentElement.nodeName!="parsererror"?doc:null};var parseJSON=$.parseJSON||function(s){return window["eval"]("("+
s+")")};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml=type==="xml"||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==="parsererror")$.error&&$.error("parsererror");if(s&&s.dataFilter)data=s.dataFilter(data,type);if(typeof data==="string")if(type==="json"||!type&&ct.indexOf("json")>=0)data=parseJSON(data);else if(type==="script"||!type&&ct.indexOf("javascript")>=0)$.globalEval(data);return data}}};
$.fn.ajaxForm=function(options){if(this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log("DOM not ready, queuing ajaxForm");$(function(){$(o.s,o.c).ajaxForm(options)});return this}log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){if(!e.isDefaultPrevented()){e.preventDefault();$(this).ajaxSubmit(options)}}).bind("click.form-plugin",function(e){var target=e.target;
var $el=$(target);if(!$el.is(":submit,input:image")){var t=$el.closest(":submit");if(t.length==0)return;target=t[0]}var form=this;form.clk=target;if(target.type=="image")if(e.offsetX!=undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY}else if(typeof $.fn.offset=="function"){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)})};
$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};$.fn.formToArray=function(semantic){var a=[];if(this.length===0)return a;var form=this[0];var els=semantic?form.getElementsByTagName("*"):form.elements;if(!els)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n)continue;if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val(),type:el.type});a.push({name:n+".x",value:form.clk_x},
{name:n+".y",value:form.clk_y})}continue}v=$.fieldValue(el,true);if(v&&v.constructor==Array)for(j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});else if(v!==null&&typeof v!="undefined")a.push({name:n,value:v,type:el.type})}if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=="image"){a.push({name:n,value:$input.val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}}return a};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))};
$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n)return;var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else if(v!==null&&typeof v!="undefined")a.push({name:this.name,value:v})});return $.param(a)};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=="undefined"||v.constructor==
Array&&!v.length)continue;v.constructor==Array?$.merge(val,v):val.push(v)}return val};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined)successful=true;if(successful&&(!n||el.disabled||t=="reset"||t=="button"||(t=="checkbox"||t=="radio")&&!el.checked||(t=="submit"||t=="image")&&el.form&&el.form.clk!=el||tag=="select"&&el.selectedIndex==-1))return null;if(tag=="select"){var index=el.selectedIndex;if(index<0)return null;var a=[],ops=
el.options;var one=t=="select-one";var max=one?index+1:ops.length;for(var i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v)v=op.attributes&&op.attributes["value"]&&!op.attributes["value"].specified?op.text:op.value;if(one)return v;a.push(v)}}return a}return $(el).val()};$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})};$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=="textarea"||includeHidden&&/hidden/.test(t))this.value="";else if(t=="checkbox"||t=="radio")this.checked=false;else if(tag=="select")this.selectedIndex=-1})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};$.fn.enable=function(b){if(b===undefined)b=true;return this.each(function(){this.disabled=!b})};
$.fn.selected=function(select){if(select===undefined)select=true;return this.each(function(){var t=this.type;if(t=="checkbox"||t=="radio")this.checked=select;else if(this.tagName.toLowerCase()=="option"){var $sel=$(this).parent("select");if(select&&$sel[0]&&$sel[0].type=="select-one")$sel.find("option").selected(false);this.selected=select}})};$.fn.ajaxSubmit.debug=false;function log(){if(!$.fn.ajaxSubmit.debug)return;var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&
window.console.log)window.console.log(msg);else if(window.opera&&window.opera.postError)window.opera.postError(msg)}})(jQuery);
(function($){$.fn.jqm=function(o){var p={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:F,ajaxText:"",target:F,modal:F,toTop:F,onShow:F,onHide:F,onLoad:F};return this.each(function(){if(this._jqm)return H[this._jqm].c=$.extend({},H[this._jqm].c,o);s++;this._jqm=s;H[s]={c:$.extend(p,$.jqm.params,o),a:F,w:$(this).addClass("jqmID"+s),s:s};if(p.trigger)$(this).jqmAddTrigger(p.trigger)})};$.fn.jqmAddClose=function(e){return hs(this,e,"jqmHide")};$.fn.jqmAddTrigger=function(e){return hs(this,
e,"jqmShow")};$.fn.jqmShow=function(t){return this.each(function(){$.jqm.open(this._jqm,t)})};$.fn.jqmHide=function(t){return this.each(function(){$.jqm.close(this._jqm,t)})};$.jqm={hash:{},open:function(s,t){var h=H[s],c=h.c,cc="."+c.closeClass,z=parseInt(h.w.css("z-index")),z=z>0?z:3E3,o=$("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":z-1,opacity:c.overlay/100});if(h.a)return F;h.t=t;h.a=true;h.w.css("z-index",z);if(c.modal){if(!A[0])L("bind");A.push(s)}else if(c.overlay>
0)h.w.jqmAddClose(o);else o=F;h.o=o?o.addClass(c.overlayClass).prependTo("body"):F;if(ie6){$("html,body").css({height:"100%",width:"100%"});if(o){o=o.css({position:"absolute"})[0];for(var y in{Top:1,Left:1})o.style.setExpression(y.toLowerCase(),"(_=(document.documentElement.scroll"+y+" || document.body.scroll"+y+"))+'px'")}}if(c.ajax){var r=c.target||h.w,u=c.ajax,r=typeof r=="string"?$(r,h.w):$(r),u=u.substr(0,1)=="@"?$(t).attr(u.substring(1)):u;r.html(c.ajaxText).load(u,function(){if(c.onLoad)c.onLoad.call(this,
h);if(cc)h.w.jqmAddClose($(cc,h.w));e(h)})}else if(cc)h.w.jqmAddClose($(cc,h.w));if(c.toTop&&h.o)h.w.before('<span id="jqmP'+h.w[0]._jqm+'"></span>').insertAfter(h.o);c.onShow?c.onShow(h):h.w.show();e(h);return F},close:function(s){var h=H[s];if(!h.a)return F;h.a=F;if(A[0]){A.pop();if(!A[0])L("unbind")}if(h.c.toTop&&h.o)$("#jqmP"+h.w[0]._jqm).after(h.w).remove();if(h.c.onHide)h.c.onHide(h);else{h.w.hide();if(h.o)h.o.remove()}return F},params:{}};var s=0,H=$.jqm.hash,A=[],ie6=$.browser.msie&&$.browser.version==
"6.0",F=false,i=$('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),e=function(h){if(ie6)if(h.o)h.o.html('<p style="width:100%;height:100%"/>').prepend(i);else if(!$("iframe.jqm",h.w)[0])h.w.prepend(i);f(h)},f=function(h){try{$(":input:visible",h.w)[0].focus()}catch(_){}},L=function(t){$()[t]("keypress",m)[t]("keydown",m)[t]("mousedown",m)},m=function(e){var h=H[A[A.length-1]],r=!$(e.target).parents(".jqmID"+h.s)[0];if(r)f(h);return!r},hs=function(w,t,
c){return w.each(function(){var s=this._jqm;$(t).each(function(){if(!this[c]){this[c]=[];$(this).click(function(){for(var i in{jqmShow:1,jqmHide:1})for(var s in this[i])if(H[this[i][s]])H[this[i][s]].w[i](this);return F})}this[c].push(s)})})}})(jQuery);
jQuery.serialize=function(_obj){if(typeof _obj.toSource!=="undefined"&&typeof _obj.callee==="undefined")return _obj.toSource();switch(typeof _obj){case "number":case "boolean":case "function":return _obj;break;case "string":return'"'+_obj+'"';break;case "object":var str;if(_obj.constructor===Array||typeof _obj.callee!=="undefined"){str="[";var i,len=_obj.length;for(i=0;i<len-1;i++)str+=jQuery.serialize(_obj[i])+",";str+=serialize(_obj[i])+"]"}else{str="{";var key;for(key in _obj)str+='"'+key+'":'+
jQuery.serialize(_obj[key])+",";str=str.replace(/\,$/,"")+"}"}return str;break;default:return"UNKNOWN";break}};
jQuery.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date;date.setTime(date.getTime()+options.expires*24*60*60*1E3)}else date=options.expires;expires="; expires="+date.toUTCString()}var path=options.path?"; path="+options.path:"";var domain=options.domain?"; domain="+
options.domain:"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};
jQuery.supercookie=function(name,key,value,options){if(typeof value!="undefined"){var cookieObj=jQuery.supercookie(name);cookieObj[key]=value;var cookieVal=escape(jQuery.serialize(cookieObj));jQuery.cookie(name,cookieVal,options)}else{var cookie=jQuery.cookie(name);var cookieObj=null;if(cookie)eval("cookieObj = "+unescape(cookie));if(!cookieObj)cookieObj={};if(key)if(cookieObj[key])return cookieObj[key];else return null;else return cookieObj}};
(function($,window,undefined){"$:nomunge";var elems=$([]),jq_resize=$.resize=$.extend($.resize,{}),timeout_id,str_setTimeout="setTimeout",str_resize="resize",str_data=str_resize+"-special-event",str_delay="delay",str_throttle="throttleWindow";jq_resize[str_delay]=250;jq_resize[str_throttle]=true;$.event.special[str_resize]={setup:function(){if(!jq_resize[str_throttle]&&this[str_setTimeout])return false;var elem=$(this);elems=elems.add(elem);$.data(this,str_data,{w:elem.width(),h:elem.height()});if(elems.length===
1)loopy()},teardown:function(){if(!jq_resize[str_throttle]&&this[str_setTimeout])return false;var elem=$(this);elems=elems.not(elem);elem.removeData(str_data);if(!elems.length)clearTimeout(timeout_id)},add:function(handleObj){if(!jq_resize[str_throttle]&&this[str_setTimeout])return false;var old_handler;function new_handler(e,w,h){var elem=$(this),data=$.data(this,str_data);if(data){data.w=w!==undefined?w:elem.width();data.h=h!==undefined?h:elem.height();old_handler.apply(this,arguments)}}if($.isFunction(handleObj)){old_handler=
handleObj;return new_handler}else{old_handler=handleObj.handler;handleObj.handler=new_handler}}};function loopy(){timeout_id=window[str_setTimeout](function(){elems.each(function(){var elem=$(this),width=elem.width(),height=elem.height(),data=$.data(this,str_data);if(data&&(width!==data.w||height!==data.h))elem.trigger(str_resize,[data.w=width,data.h=height])});loopy()},jq_resize[str_delay])}})(jQuery,this);
function initFuelNamespace(){var f;if(window.fuel==undefined)if(top.window.fuel!=undefined)f=top.window.fuel;else f={};else f=window.fuel;return f}if(typeof window.fuel=="undefined")window.fuel={};fuel.lang=function(key){return __FUEL_LOCALIZED__[key]};fuel.getFieldId=function(field,context){if(window.__FUEL_INLINE_EDITING!=undefined){var val=$(".__fuel_module__",context).attr("id");var prefix=val.split("--")[0];return prefix+"--"+field}else return field};
fuel.getModule=function(context){if(window.__FUEL_INLINE_EDITING!=undefined)return $(".__fuel_module__",context).val();else return page.module};
fuel.modalWindow=function(html,cssClass,autoResize,onLoadCallback,onCloseCallback){var modalId="__FUEL_modal__";if(!cssClass)cssClass="";var $context=$("body",window.document);if(!$("#"+modalId,$context).length)var modalHTML='<div id="'+modalId+'"><div class="loader"></div><a href="#" class="modal_close jqmClose"></a><div class="modal_content"></div></div>';else $("#"+modalId,$context).html('<div class="loader"></div><a href="#" class="modal_close jqmClose"></a><div class="modal_content"></div>');
var modalOnHide=function(){$("#"+modalId,$context).hide();$(".jqmOverlay",$context).remove();if(onCloseCallback)onCloseCallback()};$context.append(modalHTML);$modal=$("#"+modalId,$context);$modal.attr("class","__fuel__ __fuel_modal__ jqmWindow "+cssClass);var modalWidth=$modal.outerWidth();var centerWidth=-(modalWidth/2);$modal.css("marginLeft",centerWidth+"px");var jqmOpts={onHide:modalOnHide,toTop:true};if(onLoadCallback)jqmOpts.onLoad=onLoadCallback;$modal.jqm(jqmOpts).jqmShow();$modal.find(".modal_content").empty().append(html);
$modal.find("iframe").load(function(){$(".jqmWindow .loader",$context).hide();var iframe=this;var contentDoc=iframe.contentDocument;$(".cancel",contentDoc).add(".modal_close").click(function(e){e.preventDefault();$modal.jqmHide()});if(autoResize)setTimeout(function(){docHeight=fuel.calcHeight(contentDoc);$(iframe.contentWindow.parent.document).find("#"+modalId+"iframe").height(docHeight);fuel.cascadeIframeWindowSize(docHeight);$(iframe).height(docHeight)},250)});return $modal};
fuel.closeModal=function(){var modalId="__FUEL_modal__";$("#"+modalId).jqmHide()};fuel.getModule=function(context){if(window.fuel&&window.fuel.module)return window.fuel.module;if(context==undefined)context=null;var module=$(".__fuel_module__",context).length?$(".__fuel_module__",context).val():null;return module};fuel.getModuleURI=function(context){if(context==undefined)context=null;var module=$(".__fuel_module_uri__").length?$(".__fuel_module_uri__").val():null;return module};
fuel.isTop=function(){return self==top};fuel.windowLevel=function(){var level=0;var win=window;while(win!=top&&win.parent!=null){level++;win=win.parent}return level};
fuel.calcHeight=function(context){var height=0;if($("#login",context).length)var elems="#login";else var elems="#fuel_main_top_panel, #fuel_actions, #fuel_notification, #fuel_main_content_inner, #list_container, .instructions";$(elems,context).each(function(i){var outerHeight=parseInt($(this).outerHeight(false));if(outerHeight)height+=outerHeight});if(height>480)height=480;else height+=30;return height};
fuel.adjustIframeWindowSize=function(){var iframe=$(".inline_iframe",top.window.document);if(iframe.length){iframe=iframe[0];var contentDoc=iframe.contentDocument;var height=parseInt(fuel.calcHeight(contentDoc));var width=parseInt($("#fuel_main_content_inner .form",contentDoc).width())+50;$(iframe).height(height);$(iframe).width(width)}};fuel.cascadeIframeWindowSize=function(height){var level=0;if(height)height=height+100;$(".inline_iframe",top.window.document).height(height)};
if(fuel==undefined)var fuel={};
(function($){var initObj=__FUEL_INIT_PARAMS__;var pageId=initObj.pageId;var pageLocation=initObj.pageLocation;var basePath=initObj.basePath;var cookiePath=initObj.cookiePath;var imgPath=initObj.imgPath;var cssPath=initObj.cssPath;var jsPath=initObj.jsPath;var assetsImgPath=initObj.assetsImgPath;var assetsPath=initObj.assetsPath;var assetsAccept=initObj.assetsAccept;var editor=initObj.editor;var editorConfig=initObj.editorConfig;var markers=null;var X_OFFSET=16;var Y_OFFSET=16;var editorsOn=parseInt($.supercookie("fuel_bar",
"show_editable_areas"))==1;var fuelBarOn=parseInt($.supercookie("fuel_bar","show_fuel_bar"))==1;var activeEditor;var activeField;var assetFolder;var iconHeight=16;var maxAdjustLoops=fuel.maxAdjustLoops?fuel.maxAdjustLoops:10;var useAutoAdjust=fuel.useAutoAdjust===false?false:true;var resizeTags=fuel.resizeTags?fuel.resizeTags:"section,div,p,li";jQuery.resize.delay=fuel.resizeDelay?fuel.resizeDelay:1E3;function lang(key){return __FUEL_LOCALIZED__[key]}$(document).ready(function(){$("body").addClass("__fuel_inline__");
function init(){if(window.top!=window){$("#__fuel_edit_bar__").hide();return}initMarkers();initFUELBar();fuel.refresh=function(){refresh()};fuel.modalWindow=function(html,cssClass,callback){var modalId="__FUEL_modal__";if(!cssClass)cssClass="";var $context=$("body",top.window.document);var modalHtml='<a href="#" class="modal_close jqmClose"></a><div class="modal_content"></div>';if(!$("#"+modalId).size()){var modalHTML='<div id="'+modalId+'" class="__fuel__ __fuel_modal__ jqmWindow '+cssClass+'"><a href="#" class="modal_close jqmClose"></a><div class="modal_content"></div></div>';
$context.append(modalHTML)}$("#"+modalId,$context).append('<div class="loader"></div>');$modal=$("#"+modalId,$context);$modal.find(".modal_content").empty().append(html);$modal.find("iframe").load(function(){$(".jqmWindow .loader",$context).remove();var iframe=this;var contentDoc=iframe.contentDocument;var actionsHeight=$("#fuel_actions",contentDoc).outerHeight(false);var notificationsHeight=$("#fuel_notification",contentDoc).outerHeight(false);var mainContentHeight=$("#fuel_main_content_inner",contentDoc).outerHeight(false);
var listTableHeight=$("#data_table_container",contentDoc).outerHeight(false);docHeight=actionsHeight+notificationsHeight+mainContentHeight+listTableHeight+30;if(docHeight>450)docHeight=450;var docWidth=850;$(iframe).height(docHeight);$(iframe).width(docWidth)});$modal.jqm({}).jqmShow()};fuel.refreshIframeSize=function(iframe){var i=0;var interval=setInterval(function(){fuel.setIframeSize(iframe);if(i>20)clearInterval(interval);i++},100)};fuel.setIframeSize=function(iframe){var MIN_WIDTH=850;var contentDoc=
iframe.contentDocument;var docHeight=fuel.calcHeight(contentDoc);if($("#fuel_main_content_inner .form, #fuel_actions",contentDoc).size()){var width1=$("#fuel_main_content_inner .form",contentDoc).outerWidth(false)+74;var width2=$("#fuel_actions",contentDoc).outerWidth(false);var docWidth=width1>width2?width1:width2;if(docWidth<MIN_WIDTH&&$("#fuel_actions",contentDoc).size())docWidth=MIN_WIDTH}else if($("#login",contentDoc).size())docWidth=$("#login",contentDoc).width();else docWidth=$(contentDoc).width();
if(docHeight==0)docHeight=$(contentDoc).height();$(iframe).height(docHeight);$(iframe).width(docWidth)}}function initMarkers(){$(".__fuel_edit__").remove();var markers=$(".__fuel_marker__");var toggleEditOff=true;if(markers.size()>0){$body=$("body");markers.each(function(i){var $this=$(this);var module=$this.attr("data-module");if(module=="pagevariables"&&pageId!=0||module!="pagevariables"){$this.attr("id","__fuel_marker__"+i);var coords=getMarkerPosition($this);var varName=$this.attr("title");var newClass=
$this.attr("data-rel").substr(0,6)=="create"?" __fuel_edit_marker_new__":"";var publishedClass=$this.attr("data-published")=="0"?" __fuel_edit_marker_unpublished__":"";var html='<div id="__fuel_edit__'+i+'" style="left:'+coords.x+"px; top:"+coords.y+'px;" class="__fuel__ __fuel_edit__" title="'+varName+'" data-module="'+module+'">';var dataHref=$this.attr("data-href").replace(/\|/,"/");html+='<a href="'+dataHref+'" rel="'+$this.attr("data-rel")+'" class="__fuel_edit_marker__'+newClass+publishedClass+
'">';html+='<span class="__fuel_edit_marker_inner__">'+varName+"</span>";html+="</a>";html+='<div class="__fuel_edit_form__" style="display: none;"><img src="'+imgPath+'spinner_sm.gif" width="16" height="16" alt="loading"></div>';html+="</div>";$body.append(html);toggleEditOff=false}});$(".__fuel_edit_marker_inner__").hide();initEditors()}if(toggleEditOff)$("#__fuel_page_edit_toggle__").parent().hide()}function refresh(){if(editorsOn){moveMarkers();if(activeEditor)var iframe=activeEditor.find("iframe")[0]}}
function moveMarkers(){var markers=$(".__fuel_marker__");markers.each(function(i){var $this=$(this);var coords=getMarkerPosition($this);$("#__fuel_edit__"+i).css({left:coords.x,top:coords.y});if($this.filter(":hidden").size()!=0)$("#__fuel_edit__"+i).hide();else $("#__fuel_edit__"+i).show()});var editors=$(".__fuel_edit__:visible");editors.each(function(i){adjustPosition(editors,$(this),0)})}function getMarkerPosition(marker){var offset=marker.offset();var xCoord=offset.left;var yCoord=offset.top+
iconHeight;var x=xCoord<=X_OFFSET?0:xCoord-X_OFFSET;var y=yCoord<=Y_OFFSET?0:yCoord-Y_OFFSET;return{x:x,y:y}}function adjustPosition(editors,$obj,counter){editors.each(function(i){var $compareObj=$(this);var topPos=parseInt($obj.css("top"));var leftPos=parseInt($obj.css("left"));var objAttrsId=$obj.attr("id");var objCompareAttrsId=$compareObj.attr("id");if(counter<=maxAdjustLoops&&$obj.attr("id")!=$compareObj.attr("id")&&Math.abs(topPos-parseInt($compareObj.css("top")))<Y_OFFSET&&Math.abs(leftPos-
parseInt($compareObj.css("left")))<X_OFFSET){$compareObj.css("top",topPos+Y_OFFSET+"px");counter++;adjustPosition(editors,$obj,counter);return false}})}function initEditors(){var formAction="";var editors=$(".__fuel_edit__");var resetCss={height:"auto",width:"auto",opacity:1,display:"block"};var closeEditor=function(){if(activeEditor){var iframe=activeEditor.find("iframe")[0];var contentDoc=iframe.contentDocument;if($(".success",contentDoc).size())top.window.location.reload();else{activeEditor.removeClass("__fuel_edit_active__");
activeEditor.find(".__fuel_edit_marker_inner__, .__fuel_edit_form__").stop().css(resetCss).hide();activeEditor=null}}};var ajaxSubmit=function($form){$form.attr("action",formAction).ajaxSubmit(function(html){if($(html).is("error")){var msg=$(html).html();if(msg!=""||msg!="1"){$form.find(".inline_errors").html(msg).animate({backgroundColor:"#ee6060"},1500);$.scrollTo($form)}}else{closeEditor();window.location.reload(true)}return false})};$(".__fuel_edit__ .ico_cancel").on("click",function(){closeEditor();
return false});$(".__fuel_edit__ .ico_save").on("click",function(){$form=$(this).parents(".__fuel_edit_form__").find("form");ajaxSubmit($form);return false});$(".__fuel_edit__ .delete").on("click",function(){if(confirm(lang("confirm_delete"))){$form=$(this).parents(".__fuel_edit_form__").find("form");$form.find(".__fuel_inline_action__").val("delete");ajaxSubmit($form)}return false});editors.each(function(i){var $this=$(this);var module=$this.attr("data-module");var _anchor=$(".__fuel_edit_marker__",
this);_anchor.mouseover(function(){$(".__fuel_edit_marker_inner__",this).stop().css(resetCss).show()});_anchor.mouseout(function(){if(activeEditor&&activeEditor.attr("title")==$this.attr("title"))return;else $(".__fuel_edit_marker_inner__",this).stop().css(resetCss).hide()});_anchor.click(function(e){if(!activeEditor||activeEditor!=$this){if($(".__fuel_edit_form__",$this).children().not("img").size()==0){var relArr=$(this).attr("rel").split("|");var param1=relArr[0];if(module=="pagevariables")var param2=
pageId;else var param2=relArr.length>=2?relArr[1]:"";if(param1.substr(0,6)=="create"){var qString=param2.length?"?"+param2:param1;var url=$(this).attr("href")+qString}else var url=$(this).attr("href")+param1+"/"+param2;var lang=$("#__fuel_language__").val();if(lang&&lang.length)url=url+"?lang="+$("#__fuel_language__").val();if(_anchor.next(".__fuel_edit_form__").find("iframe").size()==0){var iframeId="__fuel_iframe__"+$this.attr("id");_anchor.next(".__fuel_edit_form__").html('<div class="loader"></div><iframe src="'+
url+'" id="'+iframeId+'" frameborder="0" scrolling="no" class="inline_iframe"></iframe>');$("#"+iframeId).load(function(){var iframe=this;var contentDoc=iframe.contentDocument;if(iframe.contentWindow.saved){closeEditor();window.location.reload()}else{$(".cancel",contentDoc).click(function(e){closeEditor();return false});$("#"+iframeId).prev().hide();fuel.refreshIframeSize(iframe)}})}else{var iframe=_anchor.next(".__fuel_edit_form__").find("iframe");fuel.setIframeSize(iframe)}_anchor.next(".__fuel_edit_form__").show()}else _anchor.next(".__fuel_edit_form__").show();
$(".__fuel_edit_marker_inner__",this).css(resetCss);$(this).find(".__fuel_edit_marker_inner__, .__fuel_edit_form__").show();$this.addClass("__fuel_edit_active__");if(activeEditor&&activeEditor.attr("title")!=$this.attr("title"))closeEditor();activeEditor=$this}else closeEditor();return false})})}function initFUELBar(){var hideEditors=function(){if(useAutoAdjust)$(resizeTags).unbind("resize",refresh);var elem=$("#__fuel_page_edit_toggle__");$(".__fuel_edit__").hide();editorsOn=false;elem.parent("li").removeClass("active");
$.supercookie("fuel_bar","show_editable_areas","0",{path:cookiePath})};var showEditors=function(){if(useAutoAdjust)$(resizeTags).bind("resize",refresh);refresh();var elem=$("#__fuel_page_edit_toggle__");$(".__fuel_edit__").show();editorsOn=true;elem.parent("li").addClass("active");$.supercookie("fuel_bar","show_editable_areas","1",{path:cookiePath})};var toggleEditors=function(shown){if(shown)hideEditors();else showEditors()};$("#__fuel_page_edit_toggle__").click(function(){toggleEditors(editorsOn);
return false});$("#__fuel_page_tools__").change(function(){var url=$(this).val();if(url=="")return;var html='<iframe src="'+url+"?id="+pageId+"&amp;location="+pageLocation+'" id="tool_output_iframe" frameborder="0" scrolling="no" style="border: none; height: 0px; width: 0px;"></iframe>';fuel.modalWindow(html);$(this).val("  ");return false});$("#__fuel_page_layout__").change(function(){$("#__fuel_edit_bar_form__").ajaxSubmit(function(){window.location.reload()});return false});$("#__fuel_language__").change(function(){var param=
$(this).attr("name");var lang=$(this).val();if($("#__fuel_language_mode__").val()=="segment")if($("#__fuel_language_default__").val()!=lang)var url=basePath+lang+"/"+pageLocation;else var url=basePath+pageLocation;else{var beginUrl=window.location.href.split("?")[0];var queryStr=window.location.search.substring(1);var regEx=new RegExp("&?"+param+"=[^&]*");queryStr=queryStr.replace(regEx,"");queryStr+="&"+param+"="+lang;var url=beginUrl+"?"+queryStr}window.location=url;return false});$("#__fuel_page_publish_toggle__").click(function(e){var $this=
this;var elem=$("#__fuel_page_published__");var val=elem.val()=="yes"?"no":"yes";elem.val(val);$("#__fuel_edit_bar_form__").ajaxSubmit(function(){window.location.reload()});return false});$("#__fuel_page_cache_toggle__").click(function(e){var elem=$("#__fuel_page_cached__");var val=elem.val()=="yes"?"no":"yes";elem.val(val);$("#__fuel_edit_bar_form__").ajaxSubmit(function(){window.location.reload()});return false});$("#__fuel_page_others__").change(function(){window.location=basePath+$(this).val()});
var hideFuelBar=function(animate){var elem=$("#__fuel_page_toolbar_toggle__");var exposedWidth=0;$(".__fuel__ .exposed").each(function(i){exposedWidth+=$(this).innerWidth()});var barHideX=$("#__fuel_edit_bar__").width()-(exposedWidth+1);if(animate)$("#__fuel_edit_bar__").animate({right:"-"+barHideX+"px"},500);else $("#__fuel_edit_bar__").css({right:"-"+barHideX+"px"});fuelBarOn=false;elem.parent("li").removeClass("active");$.supercookie("fuel_bar","show_fuel_bar","0",{path:cookiePath})};var showFuelBar=
function(animate){var elem=$("#__fuel_page_toolbar_toggle__");if(animate)$("#__fuel_edit_bar__").show().animate({right:"0px"},500);else $("#__fuel_edit_bar__").show().css({right:"0px"});$(".__fuel_edit_bar__").width();fuelBarOn=true;elem.parent("li").addClass("active");$.supercookie("fuel_bar","show_fuel_bar","1",{path:cookiePath})};$("#__fuel_page_toolbar_toggle__").click(function(){toggleFuelBar(fuelBarOn,true);return false});var toggleFuelBar=function(shown,animate){if(shown)hideFuelBar(animate);
else showFuelBar(animate)};$("#__fuel_edit_bar__").show();toggleFuelBar(!fuelBarOn,false);toggleEditors(!editorsOn,false)}init()})})(jQuery);
